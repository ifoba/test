!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){var n=i(1).default;(new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=new n}).controller.start()},function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return E}));var n={speed:990,roadLeftX:0,roadRightX:180,roadY:0,car:[{x:40,y:380},{x:80,y:380},{x:60,y:360},{x:40,y:340},{x:60,y:340},{x:80,y:340},{x:60,y:320}],carPosition:0,firstEnemy:{x:0,y:400},secondEnemy:{x:1,y:580},thirdEnemy:{x:0,y:760},score:0,highScore:+localStorage.getItem("score"),life:5};function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=n,this.roadLeftX=n.roadLeftX,this.roadRightX=n.roadRightX,this.roadY=n.roadY,this.car=n.car,this.carPosition=n.carPosition,this.firstEnemy=n.firstEnemy,this.secondEnemy=n.secondEnemy,this.thirdEnemy=n.thirdEnemy,this.score=n.score,this.highScore=n.highScore,this.life=n.life,this.speed=n.speed}var t,i,o;return t=e,(i=[{key:"changeData",value:function(){-120===this.firstEnemy.y?(this.firstEnemy.y=400,this.firstEnemy.x=Math.round(Math.random())):this.firstEnemy.y-=20,-120===this.secondEnemy.y?(this.secondEnemy.y=400,this.secondEnemy.x=Math.round(Math.random())):this.secondEnemy.y-=20,-120===this.thirdEnemy.y?(this.thirdEnemy.y=400,this.thirdEnemy.x=Math.round(Math.random())):this.thirdEnemy.y-=20,60===this.roadY?this.roadY=0:this.roadY+=20,this.score+=5}},{key:"loseLife",value:function(){this.life-=1,0===this.carPosition?this.carPosition=1:this.carPosition=0}},{key:"newGame",value:function(){alert("Вы набрали  ".concat(this.score," очков")),localStorage.getItem("score")<this.score&&localStorage.setItem("score",this.score),this.roadLeftX=n.roadLeftX,this.roadRightX=n.roadRightX,this.roadY=n.roadY,this.car=n.car,this.carPosition=n.carPosition,this.firstEnemy={x:0,y:400},this.secondEnemy={x:1,y:580},this.thirdEnemy={x:0,y:760},this.score=n.score,this.highScore=+localStorage.getItem("score"),this.life=n.life,this.speed=990}}])&&r(t.prototype,i),o&&r(t,o),e}();function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementById("can"),this.ctx=this.canvas.getContext("2d"),this.sizeBlock=i||20,this.contentBlock=this.sizeBlock/2,this.color=t||"#000000"}var t,i,n;return t=e,(i=[{key:"drawBlock",value:function(e,t){this.ctx.strokeStyle=this.color,this.ctx.lineWidth="2",this.ctx.beginPath(),this.ctx.rect(e,t,this.sizeBlock,this.sizeBlock),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.rect(e+5,t+5,this.contentBlock,this.contentBlock),this.ctx.stroke(),this.ctx.closePath(),this.ctx.fillStyle=this.color,this.ctx.fill()}}])&&s(t.prototype,i),n&&s(t,n),e}();function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.block=new a("#0000000a"),this.canvas=this.block.canvas,this.size=this.block.sizeBlock}var t,i,n;return t=e,(i=[{key:"drawBlock",value:function(e,t){this.block.drawBlock(e,t)}}])&&c(t.prototype,i),n&&c(t,n),e}();function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.block=new l,this.width=t||200,this.height=i||this.block.canvas.height}var t,i,n;return t=e,(i=[{key:"drawField",value:function(){for(var e=0;e<this.width;e+=this.block.size)for(var t=0;t<this.height;t+=this.block.size)this.block.drawBlock(e,t)}}])&&h(t.prototype,i),n&&h(t,n),e}();function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.block=new a,this.fenceLength=3,this.roadLeftX=t.roadLeftX,this.roadRightX=t.roadRightX,this.height=this.block.canvas.height,this.delayFence=80}var t,i,n;return t=e,(i=[{key:"drawFence",value:function(e){for(var t=-this.delayFence;t<this.height+this.delayFence;t+=this.block.sizeBlock)if(t%this.delayFence==0)for(var i=0,n=0;n<this.fenceLength;n+=1)this.block.drawBlock(this.roadLeftX,e+i+t),this.block.drawBlock(this.roadRightX,e+i+t),i+=this.block.sizeBlock}}])&&u(t.prototype,i),n&&u(t,n),e}();function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.block=new a,this.car=t.car}var t,i,n;return t=e,(i=[{key:"drawCar",value:function(e){var t=this;1===e?this.car.forEach((function(e){t.block.drawBlock(e.x,e.y)})):this.car.forEach((function(e){t.block.drawBlock(e.x+60,e.y)}))}}])&&y(t.prototype,i),n&&y(t,n),e}();function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.block=new a,this.car=t.car}var t,i,n;return t=e,(i=[{key:"drawEnemy",value:function(e,t){var i=this;e>=.5?this.car.forEach((function(e){i.block.drawBlock(e.x,e.y-t)})):this.car.forEach((function(e){i.block.drawBlock(e.x+60,e.y-t)}))}}])&&v(t.prototype,i),n&&v(t,n),e}();function w(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.block=new a,this.transparentBlock=new l,this.score=t.score,this.canvas=document.getElementById("can"),this.ctx=this.canvas.getContext("2d")}var t,i,n;return t=e,(i=[{key:"drawLife",value:function(e){for(var t=0,i=0;i<5;i+=1)this.transparentBlock.drawBlock(210+t,170),i<e&&this.block.drawBlock(210+t,170),t+=20}},{key:"drawBar",value:function(e,t,i){this.drawLife(i),this.ctx.beginPath(),this.ctx.fillStyle="#000000",this.ctx.rect(0,0,200,400),this.ctx.closePath(),this.ctx.stroke(),this.ctx.lineWidth="2",this.ctx.font="20px Arial",this.ctx.fillText("Score",235,20),e>999?this.ctx.fillText(e,240,45):e>99?this.ctx.fillText(e,245,45):e>9?this.ctx.fillText(e,250,45):this.ctx.fillText(e,258,45),this.ctx.fillText("High Score",210,80),t>999?this.ctx.fillText(t,240,110):t>99?this.ctx.fillText(t,245,110):t>9?this.ctx.fillText(t,250,110):this.ctx.fillText(t,255,110),this.ctx.fillText("Life",245,155)}}])&&w(t.prototype,i),n&&w(t,n),e}();function x(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var k=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.statusBar=new b(t),this.field=new d,this.fence=new f(t),this.car=new m(t),this.enemy=new p(t),this.ctx=document.getElementById("can").getContext("2d")}var t,i,n;return t=e,(i=[{key:"draw",value:function(){this.ctx.clearRect(0,0,320,400),this.field.drawField(),this.fence.drawFence(this.model.roadY),this.statusBar.drawBar(this.model.score,this.model.highScore,this.model.life),this.car.drawCar(this.model.carPosition),this.enemy.drawEnemy(this.model.firstEnemy.x,this.model.firstEnemy.y),this.enemy.drawEnemy(this.model.secondEnemy.x,this.model.secondEnemy.y),this.enemy.drawEnemy(this.model.thirdEnemy.x,this.model.thirdEnemy.y)}},{key:"drawStartPage",value:function(){this.ctx.lineWidth="2",this.ctx.font="40px Arial",this.ctx.fillText("Start",115,200)}}])&&x(t.prototype,i),n&&x(t,n),e}();function g(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var E=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=new o,this.view=new k(this.model),this.music=new Audio("./tetris.mp3"),this.audioCrash=new Audio("./crash.mp3")}var t,i,n;return t=e,(i=[{key:"start",value:function(){var e=this;this.music.volume=.2,this.audioCrash.volume=.2,this.music.addEventListener("ended",(function(){e.music.play()})),this.view.drawStartPage(),document.getElementById("start").addEventListener("click",(function(){e.music.play(),e.run(),document.getElementById("start").classList.add("on")}))}},{key:"run",value:function(){var e=this;this.speedUp(),this.game=setInterval((function(){e.speedUp()}),1e3),this.model.speed=990,this.saveSpeed=990;var t=!1;document.addEventListener("keydown",(function(t){"ArrowRight"===t.code&&(e.model.carPosition=0,document.querySelector(".right").classList.add("press")),"ArrowLeft"===t.code&&(e.model.carPosition=1,document.querySelector(".left").classList.add("press")),"ArrowUp"===t.code&&(e.music.volume+=.1,e.audioCrash.volume+=.1),"ArrowDown"===t.code&&(e.music.volume-=.1,e.audioCrash.volume-=.1)})),document.addEventListener("keypress",(function(i){"Space"===i.code&&!1===t&&(t=!0,e.saveSpeed=e.model.speed,e.model.speed=50,e.speedUp(),document.querySelector(".big-btn").classList.add("press"))})),document.addEventListener("keyup",(function(i){"ArrowRight"===i.code&&document.querySelector(".right").classList.remove("press"),"ArrowLeft"===i.code&&document.querySelector(".left").classList.remove("press"),"Space"===i.code&&(t=!1,clearInterval(e.interval),e.model.speed=e.saveSpeed,e.speedUp(),document.querySelector(".big-btn").classList.remove("press"))}))}},{key:"speedUp",value:function(){var e=this;this.interval&&clearInterval(this.interval),this.model.speed>50&&(this.model.speed-=20),this.interval=setInterval((function(){e.view.draw(),e.model.changeData(),e.crash()}),this.model.speed)}},{key:"crash",value:function(){var e=this;this.model.firstEnemy.y<60&&this.model.firstEnemy.y>=-80&&this.model.carPosition===this.model.firstEnemy.x&&(this.audioCrash.play(),this.model.loseLife()),this.model.secondEnemy.y<60&&this.model.secondEnemy.y>=-80&&this.model.carPosition===this.model.secondEnemy.x&&(this.audioCrash.play(),this.model.loseLife()),this.model.thirdEnemy.y<60&&this.model.thirdEnemy.y>=-80&&this.model.carPosition===this.model.thirdEnemy.x&&(this.audioCrash.play(),this.model.loseLife()),0===this.model.life&&(clearInterval(this.game),clearInterval(this.interval),this.model.newGame(),this.game=setInterval((function(){e.speedUp()}),1e3))}}])&&g(t.prototype,i),n&&g(t,n),e}()}]);